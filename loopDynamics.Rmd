---
title: "loopDynamics!"
author: "Roger Day"
date: "October 24, 2015"
output: html_document
runtime: shiny
---



```{r, echo=FALSE}

library(LevinsLoops)
data("cm.levins", package="LoopAnalyst")

make.M = reactive({
  if(!is.null(input$X1X1))
    M = cbind(c(input$X1X1, input$X1X2),
              c(input$X2X1, input$X2X2) )
  else
    M = cm.levins
  M
})

#output$sliders = 
renderUI({
  cat("Running renderUI\n")
  M = make.M()
  returnVal = lapply(t(expand.grid(names(M))), function(nodes)
         sliderInput(paste0(nodes), 
              label = paste(nodes, sep=" -> ",
              min = -1.5, max = 1.5, value = 0, step = 0.01)
         ))
  print(returnVal)
})

# inputPanel(
#   uiOutput("sliders")
# )

renderTable({
  make.M()  
})


renderPlot({
  library(LevinsLoops)
  result = dynamSim(M=  make.M(), returnLast = TRUE)
  abline(h=result)
  if(exists("previousResult")) 
    abline(h=previousResult, lty=2)
  previousResult <<- result
})
```


